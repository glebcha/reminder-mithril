"use strict";var reminder=reminder||{};reminder.Remind=function(t){this.description=m.prop(t.description),this.date=m.prop(t.date)},function(){var t="task-list";reminder.storage={get:function(){return JSON.parse(localStorage.getItem(t)||"[]")},set:function(e){localStorage.setItem(t,JSON.stringify(e))}}}(),reminder.controller=function(){this.list=reminder.storage.get(),this.list=this.list.map(function(t){return new reminder.Remind(t)}),this.description=m.prop(""),this.date=m.prop(""),this.MAX_STRING_LENGTH=100,this.add=function(){this.description()&&this.description().replace(/\s/g,"").length<=this.MAX_STRING_LENGTH&&(this.list.push(new reminder.Remind({description:this.description(),date:moment.utc().format()})),reminder.storage.set(this.list),this.description(""),this.date(""))}},reminder.view=function(){return function(t){return m("div.tasks-container",[m("h1","Напоминания"),m("input.add-remind[placeholder='Текст напоминания']",{onkeyup:function(e){13===e.keyCode?t.add():27===e.keyCode?t.description(""):m.redraw.strategy("none")},oninput:m.withAttr("value",t.description),value:t.description(),config:function(e){var i=document.getElementById("input-status");e.focus(),i.innerHTML=t.description().replace(/\s/g,"").length<=t.MAX_STRING_LENGTH?"осталось "+(t.MAX_STRING_LENGTH-t.description().replace(/\s/g,"").length)+" символов":"<span class='danger'>превышен допустимый лимит в "+t.MAX_STRING_LENGTH+" символов</span>"}}),m("button.add",{onclick:t.add.bind(t)},"+"),m("div#input-status"),m("ul#todo-list",[t.list.map(function(e,i){return m("li",[m("label",{"data-date":e.date()},e.description(),[m("span.date",moment.utc(e.date()).fromNow())]),m("span.destroy",{onclick:function(){t.list.splice(i,1),reminder.storage.set(t.list)}})])})])])}}(),m.module(document.getElementById("reminderapp"),{controller:reminder.controller,view:reminder.view}),function(){var t=function(){var t=document.querySelectorAll("#todo-list>li>label");if(t.length>0)for(var e=0;e<t.length;e++){var i=t[e],n=i.getAttribute("data-date");i.querySelector("span").innerText=moment.utc(n).fromNow()}};setInterval(t,5e3)}();