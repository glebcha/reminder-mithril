"use strict";var reminder=reminder||{};reminder.Remind=function(e){this.description=m.prop(e.description),this.date=m.prop(e.date)},function(){var e="task-list";reminder.storage={get:function(){return JSON.parse(localStorage.getItem(e)||"[]")},set:function(t){localStorage.setItem(e,JSON.stringify(t))}}}(),reminder.controller=function(){this.list=reminder.storage.get(),this.list=this.list.map(function(e){return new reminder.Remind(e)}),this.description=m.prop(""),this.MAX_STRING_LENGTH=100,this.add=function(){this.description()&&this.description().replace(/\s/g,"").length<=this.MAX_STRING_LENGTH&&(this.list.push(new reminder.Remind({description:this.description(),date:moment.utc().format()})),reminder.storage.set(this.list),this.description(""))}},reminder.view=function(){return function(e){return m("div.tasks-container",[m("h1","Напоминания"),m("input.add-remind[placeholder='Текст напоминания']",{onkeyup:function(t){13===t.keyCode?e.add():27===t.keyCode?e.description(""):m.redraw.strategy("none")},oninput:m.withAttr("value",e.description),value:e.description(),config:function(t){var i=document.getElementById("input-status");t.focus(),i.innerHTML=e.description().replace(/\s/g,"").length<=e.MAX_STRING_LENGTH?"осталось "+(e.MAX_STRING_LENGTH-e.description().replace(/\s/g,"").length)+" символов":"<span class='danger'>превышен допустимый лимит в "+e.MAX_STRING_LENGTH+" символов</span>"}}),m("button.add",{onclick:e.add.bind(e)},"+"),m("div#input-status"),m("ul#todo-list",[e.list.map(function(t,i){return m("li",[m("label",{"data-date":t.date()},t.description(),[m("span.date",moment.utc(t.date()).fromNow())]),m("span.destroy",{onclick:function(){e.list.splice(i,1),reminder.storage.set(e.list)}})])})])])}}(),m.module(document.getElementById("reminderapp"),{controller:reminder.controller,view:reminder.view}),function(){var e=function(){var e=document.querySelectorAll("#todo-list>li>label");if(e.length>0)for(var t=0;t<e.length;t++){var i=e[t],n=i.getAttribute("data-date");i.querySelector("span").innerText=moment.utc(n).fromNow()}};setInterval(e,5e3)}();